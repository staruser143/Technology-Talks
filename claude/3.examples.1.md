import com.jayway.jsonpath.JsonPath;
import com.jayway.jsonpath.Configuration;
import com.jayway.jsonpath.DocumentContext;
import com.jayway.jsonpath.PathNotFoundException;
import com.jayway.jsonpath.Option;
import java.util.List;
import java.util.Map;
import java.util.Collections;

public class JsonPathExamples {
    
    // Sample nested JSON payload
    private static final String JSON_PAYLOAD = """
    {
        "company": {
            "name": "Tech Corp",
            "founded": 2010,
            "departments": [
                {
                    "name": "Engineering",
                    "employees": [
                        {
                            "id": 1,
                            "name": "Alice",
                            "skills": ["Java", "Python"],
                            "salary": 85000
                        },
                        {
                            "id": 2,
                            "name": "Bob",
                            "skills": ["JavaScript", "React"],
                            "salary": 75000
                        }
                    ]
                },
                {
                    "name": "Sales",
                    "employees": [
                        {
                            "id": 3,
                            "name": "Charlie",
                            "skills": ["Negotiation"],
                            "salary": 65000
                        }
                    ]
                }
            ]
        },
        "projects": [
            {
                "id": 101,
                "name": "Project Alpha",
                "team": {
                    "lead": "Alice",
                    "members": ["Bob", "Charlie"]
                },
                "budget": 100000
            },
            {
                "id": 102,
                "name": "Project Beta",
                "team": {
                    "lead": "Bob",
                    "members": ["Alice"]
                },
                "budget": 150000
            }
        ]
    }
    """;
    
    public static void main(String[] args) {
        // Parse once for multiple queries
        DocumentContext context = JsonPath.parse(JSON_PAYLOAD);
        
        // Example 1: Access nested object property
        String companyName = context.read("$.company.name");
        System.out.println("Company Name: " + companyName);
        
        // Example 2: Access element in nested array
        String firstDeptName = context.read("$.company.departments[0].name");
        System.out.println("First Department: " + firstDeptName);
        
        // Example 3: Get all department names
        List<String> deptNames = context.read("$.company.departments[*].name");
        System.out.println("All Departments: " + deptNames);
        
        // Example 4: Get all employee names across all departments
        List<String> allEmployees = context.read("$.company.departments[*].employees[*].name");
        System.out.println("All Employees: " + allEmployees);
        
        // Example 5: Use recursive descent to find all 'name' fields
        List<String> allNames = context.read("$..name");
        System.out.println("All Names (recursive): " + allNames);
        
        // Example 6: Filter employees with salary > 70000
        List<Map<String, Object>> highEarners = context.read(
            "$.company.departments[*].employees[?(@.salary > 70000)]"
        );
        System.out.println("High Earners: " + highEarners);
        
        // Example 7: Get specific employee by ID across all departments
        List<String> employeeName = context.read(
            "$.company.departments[*].employees[?(@.id == 2)].name"
        );
        System.out.println("Employee with ID 2: " + employeeName);
        
        // Example 8: Get all skills from all employees (flattened)
        List<String> allSkills = context.read("$..employees[*].skills[*]");
        System.out.println("All Skills: " + allSkills);
        
        // Example 9: Filter projects with budget >= 120000
        List<String> bigProjects = context.read(
            "$.projects[?(@.budget >= 120000)].name"
        );
        System.out.println("Big Budget Projects: " + bigProjects);
        
        // Example 10: Get team members from all projects
        List<List<String>> allTeamMembers = context.read("$.projects[*].team.members");
        System.out.println("All Team Members: " + allTeamMembers);
        
        // Example 11: Get project leads where Alice is a member
        List<String> projectLeads = context.read(
            "$.projects[?(@.team.members[*] == 'Alice')].team.lead"
        );
        System.out.println("Project Leads (Alice as member): " + projectLeads);
        
        // Example 12: Complex filter - employees with Java skill
        List<String> javaDevs = context.read(
            "$.company.departments[*].employees[?(@.skills[*] == 'Java')].name"
        );
        System.out.println("Java Developers: " + javaDevs);
        
        // Example 13: Get first employee from each department
        List<String> firstEmployees = context.read(
            "$.company.departments[*].employees[0].name"
        );
        System.out.println("First Employee per Dept: " + firstEmployees);
        
        // Example 14: Array slicing - get first 2 projects
        List<Map<String, Object>> firstTwoProjects = context.read("$.projects[0:2]");
        System.out.println("First Two Projects: " + firstTwoProjects.size() + " projects");
        
        // Example 15: Multiple conditions in filter
        List<String> specificEmployees = context.read(
            "$.company.departments[*].employees[?(@.salary > 60000 && @.salary < 80000)].name"
        );
        System.out.println("Employees (60k-80k salary): " + specificEmployees);
        
        // Example 16: Get nested array length
        Integer employeeCount = context.read(
            "$.company.departments[0].employees.length()"
        );
        System.out.println("Engineering Employee Count: " + employeeCount);
    }
}

/* 
Maven Dependency:
<dependency>
    <groupId>com.jayway.jsonpath</groupId>
    <artifactId>json-path</artifactId>
    <version>2.8.0</version>
</dependency>

Gradle Dependency:
implementation 'com.jayway.jsonpath:json-path:2.8.0'
*/