
<VirtualHost *:443>
    ServerName your.server.com

    SSLEngine on
    SSLCertificateFile /etc/ssl/certs/your_cert.pem
    SSLCertificateKeyFile /etc/ssl/private/your_key.pem
    SSLCertificateChainFile /etc/ssl/certs/your_chain.pem

    # LDAP Authentication and Authorization
    <Directory "/var/www/html/secure">
        AuthType Basic
        AuthName "LDAP Authentication"
        AuthBasicProvider ldap

        AuthLDAPURL "ldaps://ldap.example.com:636/ou=users,dc=example,dc=com?uid?sub?(objectClass=person)"
        AuthLDAPBindDN "cn=admin,dc=example,dc=com"
        AuthLDAPBindPassword "admin_password"

        LDAPTrustedGlobalCert CA_BASE64 /etc/ssl/certs/ldap-server.crt

        AuthLDAPGroupAttribute member
        AuthLDAPGroupAttributeIsDN on
        Require ldap-group cn=webapp-users,ou=groups,dc=example,dc=com

        RequestHeader set X-Authenticated-User "%{REMOTE_USER}s"
    </Directory>
</VirtualHost>
