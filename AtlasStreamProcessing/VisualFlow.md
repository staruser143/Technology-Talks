Here’s a **visual diagram** of the Atlas Stream Processing pipeline for the complex use case we discussed:

![Atlas Stream Processing Pipeline Diagram](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABLAAAAJYCAYAAABy5h8aAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAA4kklEQVR4nO3dd9zW8+LH8fftjrJDiERUtKijUFbh2Hs7yN57Ez/Kduw9SwjJKcfeIwchq8jKHsfeoz1+f6SbW6mOU+6P0/P5ePR4dF/je33u676+3+t7va7vqBg/fvz4AAAAAEChZqnpAQAAAADAlAhYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAA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jRkzJmcdf1DV73vhqUen68E7V9s65ccfvs//HbBDVm0yZ9b9yyK54crzstdWnXLOCYdU3WbjlRql+/mnpNshu6Rjs3lzypF7JkkGPzMge26xelZpPHs2bNcwZx1/UIYP+7Hqfl98+nEO7rxhVmk8ezZpv2Tu/eeNk+z6d/0V52bbtZbNqk3mzIbtGuaMLvtl2I8/JJnwNz7xsF3zw3ffVm2VcsU53arG9MvpfPLv93PYrptmtaZzpeMy8+SYvbfJl59/WnX9Fed0y/Zrt8ldfXtl45UapWOzedNl3+3y4w/fT9NzzfR16qmnZr755kuzZs3Sq1evaltgTk+lrwNPNPF99pf/Joa9iVuUXX3haVmn9cLp1Lxurjz3xIwZMyYXnHxk1mw5fzZou1huu+nqqun9chfCjz54N/tsPWG5uUaL+YreQhz+1wlYMBUXnXZMepx/cs675s6stWH1U+OOHj0q+xx5cm58YHDO7nFrPnr/nXQ7dJckP296POfc8+TwE8/PvS98nLU32bba/X/47tscsP06GT16VC67+aHMO9/8GTVyRJov1zbnXXtn+jw8JJvvsFe6HtQ5Q57/7bN3LbBg/bz0/FP5+MP3fvM2vbtfkOuvOCcHn3B2ej/wYtp3WjeH7brJJB96p2bE8GHpefHp+b+zuqfPwy9n/noLpevBO+X+227KESdfmH/0fzVdzrg8c8wxV5IJK997bdkxy7Rok173PJsLb7g3X33xaY7Ze5v/6HH53zMxYo4eNSr9el2ebTq1yF19e+W23t2zyba7TXL7C089Kg/f3S/dzr8219/7fBo2apIDd1g33379VbXbXfr343LICeek1z3PprJWrZx0+M/TuueWG9LzolNz4HF/T697nkv9Boun73WXVbv/fzOvbL/nofnxh+/z9L8emOz148ePz4BH7s2nH32QVn9ZaarT+y3dDt0lr774bM7teXt63v5kxo8fn4M7b5Axo0cnSV598bl02WebrLPJdrnpwZey12HdctlZx0/2A0SS9Lr87Fxw0hG5+Ib70n71tad5HCOGD8vVF56abudfmx63PpEff/gux+73x2zBQnVtO3TKswMeqfr52QGPpG2HTlm+fceqy0ePGpUXn3sybX8KWJMzYviw9Lr87Ox1eLefwtT43H/bTdlytaVz0uG755Izjs3tfa7O8Wf3SPdbH893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TcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABRNwAIAAACgaAIWAAAAAEUTsAAAAAAomoAFAAAAQNEELAAAAACKJmABAAAAUDQBCwAAAICiCVgAAAAAFE3AAgAAAKBoAhYAAAAARROwAAAAACiagAUAAABA0QQsAAAAAIomYAEAAABQNAELAAAAgKIJWAAAAAAUTcACAAAAoGgCFgAAAABFE7AAAAAAKJqABQAAAEDRBCwAAAAAiiZgAQAAAFA0AQsAAACAoglYAAAAABTt/wGpY+Xa89EEGAAAAABJRU5ErkJggg==)

### 🔍 Diagram Breakdown

1. **Kafka Source**  
   - Reads real-time `orders` from a Kafka topic.

2. **MongoDB Lookup**  
   - Enriches each order with customer data from the `customers` collection.

3. **Windowed Aggregation**  
   - Calculates total spending per customer in 5-minute windows.

4. **Kafka Emit**  
   - Sends the enriched, aggregated data to another Kafka topic for analytics.

