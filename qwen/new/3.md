You're absolutely right! I referenced `TableModel` in the `GenericTablePostProcessor` but didn't provide the complete implementation. Here's the **full `TableModel` class and all supporting classes**:

---

## ðŸ“¦ Complete Model Classes

### `TableModel.java`
```java
package com.example.templatemerge.postprocess.model;

import java.util.List;

/**
 * Represents a data table for rendering in FreeMarker templates
 */
public class TableModel {
    private String id;
    private String title;
    private List<TableHeader> headers;
    private List<TableRow> rows;
    private Map<String, Object> totals; // Optional: aggregation totals
    private String cssClass; // Optional: custom CSS class
    
    // Constructors
    public TableModel() {}
    
    public TableModel(String title, List<TableHeader> headers, List<TableRow> rows) {
        this.title = title;
        this.headers = headers;
        this.rows = rows;
    }
    
    // Getters and Setters
    public String getId() {
        return id;
    }
    
    public void setId(String id) {
        this.id = id;
    }
    
    public String getTitle() {
        return title;
    }
    
    public void setTitle(String title) {
        this.title = title;
    }
    
    public List<TableHeader> getHeaders() {
        return headers;
    }
    
    public void setHeaders(List<TableHeader> headers) {
        this.headers = headers;
    }
    
    public List<TableRow> getRows() {
        return rows;
    }
    
    public void setRows(List<TableRow> rows) {
        this.rows = rows;
    }
    
    public Map<String, Object> getTotals() {
        return totals;
    }
    
    public void setTotals(Map<String, Object> totals) {
        this.totals = totals;
    }
    
    public String getCssClass() {
        return cssClass;
    }
    
    public void setCssClass(String cssClass) {
        this.cssClass = cssClass;
    }
}
```

---

### `TableHeader.java`
```java
package com.example.templatemerge.postprocess.model;

/**
 * Represents a table header/column definition
 */
public class TableHeader {
    private String key;        // Data key: "firstName", "address.city"
    private String label;      // Display label: "First Name", "City"
    private String width;      // CSS width: "20%", "150px"
    private String align;      // "left", "center", "right"
    private String cssClass;   // Custom CSS class
    private boolean sortable;  // Whether column is sortable
    private String sortKey;    // Alternative sort key
    
    // Constructors
    public TableHeader() {}
    
    public TableHeader(String key, String label) {
        this.key = key;
        this.label = label;
    }
    
    public TableHeader(String key, String label, String width) {
        this.key = key;
        this.label = label;
        this.width = width;
    }
    
    // Getters and Setters
    public String getKey() {
        return key;
    }
    
    public void setKey(String key) {
        this.key = key;
    }
    
    public String getLabel() {
        return label;
    }
    
    public void setLabel(String label) {
        this.label = label;
    }
    
    public String getWidth() {
        return width;
    }
    
    public void setWidth(String width) {
        this.width = width;
    }
    
    public String getAlign() {
        return align;
    }
    
    public void setAlign(String align) {
        this.align = align;
    }
    
    public String getCssClass() {
        return cssClass;
    }
    
    public void setCssClass(String cssClass) {
        this.cssClass = cssClass;
    }
    
    public boolean isSortable() {
        return sortable;
    }
    
    public void setSortable(boolean sortable) {
        this.sortable = sortable;
    }
    
    public String getSortKey() {
        return sortKey;
    }
    
    public void setSortKey(String sortKey) {
        this.sortKey = sortKey;
    }
}
```

---

### `TableRow.java`
```java
package com.example.templatemerge.postprocess.model;

import java.util.List;

/**
 * Represents a table row
 */
public class TableRow {
    private int index;         // 1-based row index
    private String id;         // Optional row ID
    private String cssClass;   // Optional CSS class (e.g., "highlight", "error")
    private List<TableCell> cells;
    private Object rowData;    // Original data object (for advanced templates)
    
    // Constructors
    public TableRow() {}
    
    public TableRow(int index, List<TableCell> cells) {
        this.index = index;
        this.cells = cells;
    }
    
    // Getters and Setters
    public int getIndex() {
        return index;
    }
    
    public void setIndex(int index) {
        this.index = index;
    }
    
    public String getId() {
        return id;
    }
    
    public void setId(String id) {
        this.id = id;
    }
    
    public String getCssClass() {
        return cssClass;
    }
    
    public void setCssClass(String cssClass) {
        this.cssClass = cssClass;
    }
    
    public List<TableCell> getCells() {
        return cells;
    }
    
    public void setCells(List<TableCell> cells) {
        this.cells = cells;
    }
    
    public Object getRowData() {
        return rowData;
    }
    
    public void setRowData(Object rowData) {
        this.rowData = rowData;
    }
}
```

---

### `TableCell.java`
```java
package com.example.templatemerge.postprocess.model;

/**
 * Represents a table cell
 */
public class TableCell {
    private String key;        // Data key that generated this cell
    private String value;      // Display value
    private String rawValue;   // Original value (before transforms)
    private String style;      // Inline CSS style
    private String cssClass;   // CSS class
    private boolean htmlSafe;  // Whether value contains HTML (don't escape)
    
    // Constructors
    public TableCell() {}
    
    public TableCell(String value) {
        this.value = value;
    }
    
    public TableCell(String key, String value) {
        this.key = key;
        this.value = value;
    }
    
    // Getters and Setters
    public String getKey() {
        return key;
    }
    
    public void setKey(String key) {
        this.key = key;
    }
    
    public String getValue() {
        return value;
    }
    
    public void setValue(String value) {
        this.value = value;
    }
    
    public String getRawValue() {
        return rawValue;
    }
    
    public void setRawValue(String rawValue) {
        this.rawValue = rawValue;
    }
    
    public String getStyle() {
        return style;
    }
    
    public void setStyle(String style) {
        this.style = style;
    }
    
    public String getCssClass() {
        return cssClass;
    }
    
    public void setCssClass(String cssClass) {
        this.cssClass = cssClass;
    }
    
    public boolean isHtmlSafe() {
        return htmlSafe;
    }
    
    public void setHtmlSafe(boolean htmlSafe) {
        this.htmlSafe = htmlSafe;
    }
}
```

---

## ðŸ”§ Updated GenericTablePostProcessor (with correct imports)

### `GenericTablePostProcessor.java` (Updated Imports)
```java
package com.example.templatemerge.postprocess;

import com.example.templatemerge.postprocess.model.*;
import com.example.templatemerge.service.HtmlToPdfService;
import com.example.templatemerge.util.EnhancedPathResolver;
import com.example.templatemerge.model.TransformSpec;
import org.apache.pdfbox.pdmodel.PDDocument;
import org.springframework.stereotype.Component;

import java.io.ByteArrayInputStream;
import java.util.*;
import java.util.stream.Collectors;

@Component("generic-table")
public class GenericTablePostProcessor implements PdfPostProcessor {
    
    private final HtmlToPdfService htmlToPdfService;
    
    public GenericTablePostProcessor(HtmlToPdfService htmlToPdfService) {
        this.htmlToPdfService = htmlToPdfService;
    }
    
    @Override
    public void process(PDDocument mainDoc, PdfProcessingContext context) throws Exception {
        // Get configuration
        String dataSource = context.getConfigValue("dataSource", "source");
        String dataPath = context.getRequiredConfigValue("dataPath");
        List<Map<String, Object>> filters = context.getConfigValue("filters", Collections.emptyList());
        List<ColumnConfig> columns = context.getConfigValue("columns", Collections.emptyList());
        String templateName = context.getConfigValue("template", "classpath:templates/default_table.ftl");
        String title = context.getConfigValue("title", "Data Table");
        String tableId = context.getConfigValue("tableId", "table");
        
        // Get base data
        Object baseData = getDataSource(dataSource, context);
        
        // Extract data using path
        Object rawData = EnhancedPathResolver.read(baseData, dataPath);
        
        // Apply filters
        List<?> filteredData = applyFilters(rawData, filters);
        
        // Build table model
        TableModel tableModel = buildTableModel(filteredData, columns, title, tableId);
        
        // Generate PDF from template
        byte[] pdfBytes = htmlToPdfService.generateFromTemplate(templateName, 
            Map.of("table", tableModel, "context", buildContext(context)));
        
        // Append to main document
        appendPages(mainDoc, pdfBytes);
    }
    
    // ... rest of the implementation (same as before, but with EnhancedPathResolver)
    
    private TableModel buildTableModel(List<?> data, List<ColumnConfig> columns, String title, String tableId) {
        TableModel model = new TableModel();
        model.setTitle(title);
        model.setId(tableId);
        
        // Build headers
        List<TableHeader> headers = new ArrayList<>();
        for (ColumnConfig col : columns) {
            TableHeader header = new TableHeader();
            header.setKey(col.getKey());
            header.setLabel(col.getLabel());
            header.setWidth(col.getWidth());
            header.setAlign(col.getAlign());
            header.setCssClass(col.getCssClass());
            headers.add(header);
        }
        model.setHeaders(headers);
        
        // Build rows
        List<TableRow> rows = new ArrayList<>();
        for (int i = 0; i < data.size(); i++) {
            Object item = data.get(i);
            TableRow row = new TableRow();
            row.setIndex(i + 1);
            row.setRowData(item); // Store original data for advanced templates
            
            List<TableCell> cells = new ArrayList<>();
            for (ColumnConfig col : columns) {
                String value = extractValue(item, col.getKey(), col.getTransforms());
                TableCell cell = new TableCell();
                cell.setKey(col.getKey());
                cell.setValue(value);
                cell.setStyle(col.getStyle());
                cell.setCssClass(col.getCellCssClass());
                cell.setHtmlSafe(col.isHtmlSafe());
                cells.add(cell);
            }
            row.setCells(cells);
            rows.add(row);
        }
        model.setRows(rows);
        
        return model;
    }
    
    // ... other methods (same as before)
}
```

---

## ðŸ“„ Enhanced ColumnConfig.java (Complete)

```java
package com.example.templatemerge.postprocess;

import com.example.templatemerge.model.TransformSpec;
import java.util.List;

/**
 * Configuration for a table column
 */
public class ColumnConfig {
    private String key;            // Data path: "firstName", "address.city"
    private String label;          // Display name: "First Name"
    private String width;          // CSS width: "20%", "150px"
    private String align;          // "left", "center", "right"
    private String style;          // Inline CSS: "font-weight: bold;"
    private String cssClass;       // Header CSS class
    private String cellCssClass;   // Cell CSS class
    private boolean htmlSafe;      // Whether value contains HTML
    private List<TransformSpec> transforms; // Transformations to apply
    
    // Constructors
    public ColumnConfig() {}
    
    public ColumnConfig(String key, String label) {
        this.key = key;
        this.label = label;
    }
    
    // Getters and Setters
    public String getKey() { return key; }
    public void setKey(String key) { this.key = key; }
    
    public String getLabel() { return label; }
    public void setLabel(String label) { this.label = label; }
    
    public String getWidth() { return width; }
    public void setWidth(String width) { this.width = width; }
    
    public String getAlign() { return align; }
    public void setAlign(String align) { this.align = align; }
    
    public String getStyle() { return style; }
    public void setStyle(String style) { this.style = style; }
    
    public String getCssClass() { return cssClass; }
    public void setCssClass(String cssClass) { this.cssClass = cssClass; }
    
    public String getCellCssClass() { return cellCssClass; }
    public void setCellCssClass(String cellCssClass) { this.cellCssClass = cellCssClass; }
    
    public boolean isHtmlSafe() { return htmlSafe; }
    public void setHtmlSafe(boolean htmlSafe) { this.htmlSafe = htmlSafe; }
    
    public List<TransformSpec> getTransforms() { return transforms; }
    public void setTransforms(List<TransformSpec> transforms) { this.transforms = transforms; }
}
```

---

## ðŸ“„ FreeMarker Template Using Full Model

### `advanced_table.ftl`
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        .table-container { margin: 20px 0; }
        .table-title { 
            font-size: 16px; 
            font-weight: bold; 
            margin-bottom: 10px; 
            color: #333;
        }
        table.data-table { 
            width: 100%; 
            border-collapse: collapse; 
            font-size: 10px;
            margin-top: 10px;
        }
        th { 
            background-color: #f2f2f2; 
            padding: 8px; 
            text-align: left;
            border: 1px solid #ddd;
            font-weight: bold;
        }
        td { 
            padding: 6px; 
            border: 1px solid #ddd;
        }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        
        /* Dynamic CSS classes from model */
        .highlight { background-color: #fff3cd; }
        .error { background-color: #f8d7da; color: #721c24; }
        .success { background-color: #d4edda; color: #155724; }
    </style>
</head>
<body>
    <div class="table-container">
        <div class="table-title">${table.title!""}</div>
        <table id="${table.id!""}" class="data-table <#if table.cssClass??>${table.cssClass}</#if>">
            <thead>
                <tr>
                    <#list table.headers as header>
                        <th 
                            <#if header.width??>style="width: ${header.width};"</#if>
                            <#if header.cssClass??>class="${header.cssClass}"</#if>
                            <#if header.align? && header.align == "center">class="text-center"</#if>
                            <#if header.align? && header.align == "right">class="text-right"</#if>
                        >
                            ${header.label!""}
                            <#if header.sortable>
                                <span class="sort-indicator">â†•</span>
                            </#if>
                        </th>
                    </#list>
                </tr>
            </thead>
            <tbody>
                <#if table.rows?has_content>
                    <#list table.rows as row>
                        <tr 
                            <#if row.cssClass??>class="${row.cssClass}"</#if>
                            <#if row.id??>id="${row.id}"</#if>
                        >
                            <#list row.cells as cell>
                                <td 
                                    <#if cell.style??>style="${cell.style}"</#if>
                                    <#if cell.cssClass??>class="${cell.cssClass}"</#if>
                                >
                                    <#if cell.htmlSafe>
                                        ${cell.value}
                                    <#else>
                                        ${cell.value!""}
                                    </#if>
                                </td>
                            </#list>
                        </tr>
                    </#list>
                    
                    <#-- Totals row (if configured) -->
                    <#if table.totals?has_content>
                        <tr class="totals-row">
                            <#list table.headers as header>
                                <#if header.key == "label">
                                    <td><strong>Totals:</strong></td>
                                <#else>
                                    <td>
                                        <#if table.totals[header.key]??>
                                            ${table.totals[header.key]}
                                        <#else>
                                            &nbsp;
                                        </#if>
                                    </td>
                                </#if>
                            </#list>
                        </tr>
                    </#if>
                <#else>
                    <tr>
                        <td colspan="${table.headers?size}" style="text-align: center; font-style: italic;">
                            No data available
                        </td>
                    </tr>
                </#if>
            </tbody>
        </table>
    </div>
</body>
</html>
```

---

## âœ… Key Features of This Model

| Feature | Description |
|---------|-------------|
| **âœ… Rich metadata** | Each level (table, header, row, cell) has CSS and styling options |
| **âœ… Original data access** | `rowData` field preserves original objects for advanced templates |
| **âœ… HTML-safe rendering** | `htmlSafe` flag prevents double-escaping |
| **âœ… Extensible** | Easy to add new properties (sorting, formatting, etc.) |
| **âœ… Type-safe** | Proper Java classes instead of Maps |

This gives you a **production-ready, flexible table model** that can handle everything from simple data tables to complex financial reports with totals, conditional styling, and advanced formatting.