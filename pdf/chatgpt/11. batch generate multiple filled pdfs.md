Absolutely! Letâ€™s extend the workflow to **batch-generate multiple personalized PDFs** for many customers.

Weâ€™ll use the same steps as before, but loop through a **list of customers**, generating a separate PDF for each.

---

## Example: Batch PDF Generation

```java
import org.apache.pdfbox.multipdf.PDFMergerUtility;
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.pdmodel.PDPage;
import org.apache.pdfbox.pdmodel.PDPageContentStream;
import org.apache.pdfbox.pdmodel.common.PDRectangle;
import org.apache.pdfbox.pdmodel.font.PDType1Font;
import org.apache.pdfbox.pdmodel.graphics.image.PDImageXObject;
import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotationWidget;
import org.apache.pdfbox.pdmodel.interactive.form.*;

import java.io.File;
import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;
import java.util.List;

public class BatchPdfGenerator {

    public static void main(String[] args) {
        // Example customer data
        List<Customer> customers = Arrays.asList(
                new Customer("Sridhar Balasubramanian", "Germany"),
                new Customer("Ananya Sharma", "India"),
                new Customer("John Doe", "USA")
        );

        for (Customer c : customers) {
            generatePdfForCustomer(c);
        }

        System.out.println("Batch PDF generation completed!");
    }

    private static void generatePdfForCustomer(Customer customer) {
        try (PDDocument document = new PDDocument()) {

            // ---------------- Step 1: Create Form Page ----------------
            PDPage formPage = new PDPage(PDRectangle.A4);
            document.addPage(formPage);

            PDAcroForm acroForm = new PDAcroForm(document);
            document.getDocumentCatalog().setAcroForm(acroForm);

            // Text Field
            PDTextField nameField = new PDTextField(acroForm);
            nameField.setPartialName("name");
            acroForm.getFields().add(nameField);
            PDAnnotationWidget nameWidget = nameField.getWidgets().get(0);
            nameWidget.setRectangle(new PDRectangle(100, 700, 200, 20));
            nameWidget.setPage(formPage);
            formPage.getAnnotations().add(nameWidget);

            // Checkbox
            PDCheckBox agreeBox = new PDCheckBox(acroForm);
            agreeBox.setPartialName("agreement");
            acroForm.getFields().add(agreeBox);
            PDAnnotationWidget checkWidget = agreeBox.getWidgets().get(0);
            checkWidget.setRectangle(new PDRectangle(100, 650, 20, 20));
            checkWidget.setPage(formPage);
            formPage.getAnnotations().add(checkWidget);

            // Radio Button
            PDRadioButton genderGroup = new PDRadioButton(acroForm);
            genderGroup.setPartialName("gender");
            acroForm.getFields().add(genderGroup);
            PDAnnotationWidget radio1 = new PDAnnotationWidget();
            radio1.setRectangle(new PDRectangle(100, 600, 20, 20));
            radio1.setPage(formPage);
            PDAnnotationWidget radio2 = new PDAnnotationWidget();
            radio2.setRectangle(new PDRectangle(160, 600, 20, 20));
            radio2.setPage(formPage);
            formPage.getAnnotations().add(radio1);
            formPage.getAnnotations().add(radio2);
            genderGroup.getWidgets().add(radio1);
            genderGroup.getWidgets().add(radio2);
            genderGroup.setExportValues(new String[]{"Male","Female"});

            // Dropdown
            PDComboBox countryBox = new PDComboBox(acroForm);
            countryBox.setPartialName("country");
            acroForm.getFields().add(countryBox);
            PDAnnotationWidget comboWidget = countryBox.getWidgets().get(0);
            comboWidget.setRectangle(new PDRectangle(100, 550, 150, 20));
            comboWidget.setPage(formPage);
            formPage.getAnnotations().add(comboWidget);
            countryBox.setOptions(new String[]{"India","USA","UK","Germany"});

            // Labels
            try (PDPageContentStream cs = new PDPageContentStream(document, formPage)) {
                cs.beginText();
                cs.setFont(PDType1Font.HELVETICA_BOLD, 12);
                cs.newLineAtOffset(100, 725);
                cs.showText("Name:");
                cs.endText();
                cs.beginText();
                cs.newLineAtOffset(130, 655);
                cs.showText("I Agree");
                cs.endText();
                cs.beginText();
                cs.newLineAtOffset(100, 620);
                cs.showText("Gender: Male   Female");
                cs.endText();
                cs.beginText();
                cs.newLineAtOffset(100, 570);
                cs.showText("Country:");
                cs.endText();
            }

            // ---------------- Step 2: Fill Form ----------------
            nameField.setValue(customer.name);
            agreeBox.check();
            genderGroup.setValue("Male"); // can vary if needed
            countryBox.setValue(customer.country);

            // ---------------- Step 3: Flatten ----------------
            acroForm.flatten();

            // ---------------- Step 4: Add Summary Page ----------------
            PDPage summaryPage = new PDPage(PDRectangle.A4);
            document.addPage(summaryPage);
            try (PDPageContentStream cs = new PDPageContentStream(document, summaryPage)) {
                cs.beginText();
                cs.setFont(PDType1Font.HELVETICA_BOLD, 14);
                cs.newLineAtOffset(100, 700);
                cs.showText("Summary Page (Dynamic)");
                cs.endText();
                cs.beginText();
                cs.setFont(PDType1Font.HELVETICA, 12);
                cs.newLineAtOffset(100, 670);
                cs.showText("Customer: " + customer.name);
                cs.endText();
                cs.beginText();
                cs.newLineAtOffset(100, 650);
                cs.showText("Country: " + customer.country);
                cs.endText();
            }

            // ---------------- Step 5: Add Dynamic Cover Page ----------------
            PDPage coverPage = new PDPage(PDRectangle.A4);
            String reportTitle = "Customer Report";
            String reportDate = new SimpleDateFormat("dd MMM yyyy").format(new Date());
            String logoPath = "logo.png"; // optional

            try (PDPageContentStream cs = new PDPageContentStream(document, coverPage)) {
                // Logo
                File logoFile = new File(logoPath);
                if (logoFile.exists()) {
                    PDImageXObject logo = PDImageXObject.createFromFile(logoPath, document);
                    cs.drawImage(logo, 200, 720, 200, 100);
                }
                // Title
                cs.beginText();
                cs.setFont(PDType1Font.HELVETICA_BOLD, 24);
                cs.newLineAtOffset(200, 650);
                cs.showText(reportTitle);
                cs.endText();
                // Customer
                cs.beginText();
                cs.setFont(PDType1Font.HELVETICA, 16);
                cs.newLineAtOffset(200, 600);
                cs.showText("Customer: " + customer.name);
                cs.endText();
                // Date
                cs.beginText();
                cs.setFont(PDType1Font.HELVETICA, 14);
                cs.newLineAtOffset(200, 570);
                cs.showText("Generated on: " + reportDate);
                cs.endText();
            }
            document.addPage(0, coverPage);

            // ---------------- Step 6: Save individual PDF ----------------
            String filename = "Report_" + customer.name.replaceAll(" ", "_") + ".pdf";
            document.save(filename);
            System.out.println("PDF generated for " + customer.name);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    // Simple Customer class
    static class Customer {
        String name;
        String country;
        Customer(String name, String country) {
            this.name = name;
            this.country = country;
        }
    }
}
```

---

## âœ… What This Does

* Loops through a **list of customers**.
* Creates a **personalized PDF** for each:

  * Dynamic **cover page** (logo, customer name, date).
  * Filled **form page** â†’ flattened.
  * Dynamic **summary page**.
* Saves each PDF with a **unique filename**.

---

ðŸ’¡ **Next steps you can add**:

1. Merge **Annexure.pdf** for each customer.
2. Add **page numbers** dynamically for each PDF.
3. Batch-generate hundreds of PDFs automatically.

---

If you want, I can provide a **version that includes merging annexure + page numbers for each batch PDF** so itâ€™s fully production-ready.

Do you want me to do that?
